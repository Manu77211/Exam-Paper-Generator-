<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Paper Generator</title>
    <link rel="stylesheet" href="styles.css">

    <script src="script.js"></script>

    
</head>
<body>
    <div id="home-page">
        <h1>Welcome to Exam Paper Generator</h1>

        <main>
            <!-- Navigation Buttons -->
            <div class="button-container">
                <a href="/upload.html" class="btn">Upload Paper</a>
                <a href="/add-question.html" class="btn">Add Question</a>
                <button type="button" onclick="showRemoveQuestionForm()">Remove Question</button>
                
            </div>

            <!-- The Modal for Remove Question -->
            <div id="remove-question-modal" class="modal">
                <div class="modal-content">
                    <h2>Remove Question</h2>
                    <form id="remove-question-form">
                        <label for="remove-question-id">Enter Question ID to Remove:</label>
                        <input type="number" id="remove-question-id" placeholder="Question ID" required>
                        <div class="modal-actions">
                            <button type="button" id="remove-btn" onclick="removeQuestion()">Remove</button>
                            <button type="button" id="close-btn" onclick="closeRemoveQuestionForm()">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
            
        </main>

        <!-- Generate Paper Section -->
        <button id="generate-paper-btn">Generate Paper</button>

        <!-- Pop-up Section for Generating Paper -->
        <div id="generate-options" style="display:none;">
            <h2>Choose Number of Questions for Each Difficulty:</h2>
            <label for="easy">Easy:</label>
            <input type="number" id="easy" name="easy" min="0">
            <label for="medium">Medium:</label>
            <input type="number" id="medium" name="medium" min="0">
            <label for="hard">Hard:</label>
            <input type="number" id="hard" name="hard" min="0">
            <button onclick="generateQuestions()">Generate</button>
            <button onclick="cancelGeneration()">Cancel</button>
        </div>
    </div>

    <script>
        // Function to show the Remove Question form (modal)
        function showRemoveQuestionForm() {
    document.getElementById("remove-question-modal").style.display = "block";
    document.getElementById("modal-overlay").style.display = "block";
}

// Close the modal when clicking "Cancel" or outside the modal
function closeRemoveQuestionForm() {
    document.getElementById("remove-question-modal").style.display = "none";
    document.getElementById("modal-overlay").style.display = "none";
}

// Close modal if clicking outside of it
window.onclick = function(event) {
    let modal = document.getElementById("remove-question-modal");
    let overlay = document.getElementById("modal-overlay");
    if (event.target === overlay) {
        modal.style.display = "none";
        overlay.style.display = "none";
    }
};

// Function to handle the remove operation
async function removeQuestion() {
    const questionId = document.getElementById("remove-question-id").value.trim();

    if (questionId === "") {
        alert("Please enter a valid Question ID.");
        return;
    }

    try {
        const response = await fetch("/remove-question", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ id: questionId }),
        });

        if (response.ok) {
            const result = await response.text();
            alert(result);  // Show success message from the backend
        } else {
            const error = await response.text();
            alert(error);  // Show error message if question ID is not found
        }
    } catch (error) {
        console.error("Error removing question:", error);
        alert("An error occurred while removing the question. Try again later.");
    }

    // Clear the input field and close the modal
    document.getElementById("remove-question-id").value = "";
    closeRemoveQuestionForm();
}

    
    

        // Show the popup for entering question quantities
        document.getElementById('generate-paper-btn').addEventListener('click', function () {
            document.getElementById('generate-options').style.display = 'block';
        });

        // Function to collect input and redirect to generate-paper.html
        function generateQuestions() {
            const easyCount = document.getElementById('easy').value;
            const mediumCount = document.getElementById('medium').value;
            const hardCount = document.getElementById('hard').value;

            if (easyCount === '' && mediumCount === '' && hardCount === '') {
                alert('Please enter the number of questions for at least one difficulty level.');
                return;
            }

            // Store data in localStorage
            localStorage.setItem('easyCount', easyCount);
            localStorage.setItem('mediumCount', mediumCount);
            localStorage.setItem('hardCount', hardCount);

            // Redirect to generate-paper.html
            window.location.href = '/generate-paper.html';
        }

        // Cancel generation (close popup)
        function cancelGeneration() {
            document.getElementById('generate-options').style.display = 'none';
        }
    </script>
</body>
</html>
